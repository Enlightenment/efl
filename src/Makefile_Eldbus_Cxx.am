
if HAVE_CXX11

### Generated headers

generated_eldbus_cxx_bindings = $(eldbus_eolian_files:%.eo=%.eo.hh)
generated_eldbus_cxx_impl_bindings = $(eldbus_eolian_files:%.eo=%.eo.impl.hh)

lib/eldbus/Eldbus_Model.hh: $(generated_eldbus_cxx_bindings)
	@echo @ECHO_E@ "#ifndef EFL_CXX_ELDBUS_MODEL_HH\n#define EFL_CXX_ELDBUS_MODEL_HH\n" > $(top_builddir)/src/lib/eldbus/Eldbus_Model.hh
	@echo @ECHO_E@ "#include <Eldbus_Model.h>" >> $(top_builddir)/src/lib/eldbus/Eldbus_Model.hh
	@echo @ECHO_E@ "#ifdef EFL_BETA_API_SUPPORT" >> $(top_builddir)/src/lib/eldbus/Eldbus_Model.hh
	@for i in $(generated_eldbus_cxx_bindings); do echo "#include <$$(basename $$i)>" >> $(top_builddir)/src/lib/eldbus/Eldbus_Model.hh; done
	@echo @ECHO_E@ "#endif\n\n#endif\n" >> $(top_builddir)/src/lib/eldbus/Eldbus_Model.hh

generated_eldbus_cxx_all = \
	$(generated_eldbus_cxx_bindings) \
	$(generated_eldbus_cxx_impl_bindings) \
	lib/eldbus/Eldbus_Model.hh

CLEANFILES += $(generated_eldbus_cxx_all)

nodist_installed_eldbuscxxmainheaders_DATA = $(generated_eldbus_cxx_all)

### Library

installed_eldbuscxxmainheadersdir = $(includedir)/eldbus_cxx-@VMAJ@
dist_installed_eldbuscxxmainheaders_DATA = \
bindings/eldbus_cxx/eldbus_basic.hh \
bindings/eldbus_cxx/eldbus_error.hh \
bindings/eldbus_cxx/eldbus_freedesktop.hh \
bindings/eldbus_cxx/Eldbus.hh \
bindings/eldbus_cxx/eldbus_integer_sequence.hh \
bindings/eldbus_cxx/eldbus_message_arguments.hh \
bindings/eldbus_cxx/eldbus_message.hh \
bindings/eldbus_cxx/eldbus_proxy_call.hh \
bindings/eldbus_cxx/eldbus_raw_tuple.hh \
bindings/eldbus_cxx/eldbus_service.hh \
bindings/eldbus_cxx/eldbus_signature_traits.hh

### Unit tests

if EFL_ENABLE_TESTS

check_PROGRAMS += tests/eldbus_cxx/eldbus_cxx_suite
TESTS += tests/eldbus_cxx/eldbus_cxx_suite

tests_eldbus_cxx_eldbus_cxx_suite_SOURCES = \
tests/eldbus_cxx/eldbus_cxx_suite.cc \
tests/eldbus_cxx/eldbus_cxx_test_eldbus_connect.cc \
tests/eldbus_cxx/eldbus_cxx_test_eldbus_client.cc

tests_eldbus_cxx_eldbus_cxx_suite_CPPFLAGS = \
-I$(top_builddir)/src/bindings/eina_cxx \
-I$(top_srcdir)/src/bindings/eina_cxx \
-I$(top_builddir)/src/bindings/ecore_cxx \
-I$(top_srcdir)/src/bindings/ecore_cxx \
-I$(top_builddir)/src/bindings/eldbus_cxx \
-I$(top_srcdir)/src/bindings/eldbus_cxx \
-I$(top_builddir)/src/lib/efl \
-I$(top_builddir)/src/lib/efl/interfaces \
-I$(top_builddir)/src/lib/ecore \
-DTESTS_BUILD_DIR=\"$(top_builddir)/src/tests/eldbus\" \
@CHECK_CFLAGS@ @ECORE_CXX_CFLAGS@ @EINA_CXX_CFLAGS@ @EINA_CFLAGS@ \
@ECORE_CFLAGS@ @EO_CFLAGS@ @EO_CXX_CFLAGS@ @ELDBUS_CFLAGS@

tests_eldbus_cxx_eldbus_cxx_suite_LDADD = @CHECK_LIBS@ @USE_ELDBUS_LIBS@
tests_eldbus_cxx_eldbus_cxx_suite_DEPENDENCIES = @USE_ELDBUS_INTERNAL_LIBS@

endif

endif
